<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <title>Survey</title>
</head>
<body>
    <div class="container">
        <h1>Survey</h1>
        <hr class="my-2">
        <h2>User Info</h2>
        <div class="form-group">
            <label for="usr">Name:</label>
            <input type="text" class="form-control" id="usr">
        </div>
        <div class="form-group">
            <label for="profPic">Image (url):</label>
            <input type="text" class="form-control" id="profPic">
        </div>
              
        <hr class="my-2">
        <div id="questions" class="text-center">
            <h2 class="text-left">Rate each of these in regards to the types of movies you enjoy.</h2>
            <h4 class="text-left">1 for strongly dislike, and 5 for absolutely love!</h4>
            <hr class="my-2">
            <h3>Action</h3>
            <div class="options">
                <label class="radio-inline"><input type="radio" name="q1" value="1">1</label>
                <label class="radio-inline"><input type="radio" name="q1" value="2">2</label>
                <label class="radio-inline"><input type="radio" name="q1" value="3" checked>3</label>
                <label class="radio-inline"><input type="radio" name="q1" value="4">4</label>
                <label class="radio-inline"><input type="radio" name="q1" value="5">5</label>
            </div>
            <hr class="my-2">
            <h3>Horror</h3>
            <div class="options">
                <label class="radio-inline"><input type="radio" name="q2" value="1">1</label>
                <label class="radio-inline"><input type="radio" name="q2" value="2">2</label>
                <label class="radio-inline"><input type="radio" name="q2" value="3" checked>3</label>
                <label class="radio-inline"><input type="radio" name="q2" value="4">4</label>
                <label class="radio-inline"><input type="radio" name="q2" value="5">5</label>
            </div>
            <hr class="my-2">
            <h3>Comedy</h3>
            <div class="options">
                <label class="radio-inline"><input type="radio" name="q3" value="1">1</label>
                <label class="radio-inline"><input type="radio" name="q3" value="2">2</label>
                <label class="radio-inline"><input type="radio" name="q3" value="3" checked>3</label>
                <label class="radio-inline"><input type="radio" name="q3" value="4">4</label>
                <label class="radio-inline"><input type="radio" name="q3" value="5">5</label>
            </div>
            <hr class="my-2">
            <h3>Mystery</h3>
            <div class="options">
                <label class="radio-inline"><input type="radio" name="q4" value="1">1</label>
                <label class="radio-inline"><input type="radio" name="q4" value="2">2</label>
                <label class="radio-inline"><input type="radio" name="q4" value="3" checked>3</label>
                <label class="radio-inline"><input type="radio" name="q4" value="4">4</label>
                <label class="radio-inline"><input type="radio" name="q4" value="5">5</label>
            </div>
            <hr class="my-2">
            <h3>Drama</h3>
            <div class="options">
                <label class="radio-inline"><input type="radio" name="q5" value="1">1</label>
                <label class="radio-inline"><input type="radio" name="q5" value="2">2</label>
                <label class="radio-inline"><input type="radio" name="q5" value="3" checked>3</label>
                <label class="radio-inline"><input type="radio" name="q5" value="4">4</label>
                <label class="radio-inline"><input type="radio" name="q5" value="5">5</label>
            </div>
            <hr class="my-2">
            <h3>Sappy</h3>
            <div class="options">
                <label class="radio-inline"><input type="radio" name="q6" value="1">1</label>
                <label class="radio-inline"><input type="radio" name="q6" value="2">2</label>
                <label class="radio-inline"><input type="radio" name="q6" value="3" checked>3</label>
                <label class="radio-inline"><input type="radio" name="q6" value="4">4</label>
                <label class="radio-inline"><input type="radio" name="q6" value="5">5</label>
            </div>
            <hr class="my-2">
            <h3>Campy</h3>
            <div class="options">
                <label class="radio-inline"><input type="radio" name="q7" value="1">1</label>
                <label class="radio-inline"><input type="radio" name="q7" value="2">2</label>
                <label class="radio-inline"><input type="radio" name="q7" value="3" checked>3</label>
                <label class="radio-inline"><input type="radio" name="q7" value="4">4</label>
                <label class="radio-inline"><input type="radio" name="q7" value="5">5</label>
            </div>
            <hr class="my-2">
            <h3>Serious</h3>
            <div class="options">
                <label class="radio-inline"><input type="radio" name="q8" value="1">1</label>
                <label class="radio-inline"><input type="radio" name="q8" value="2">2</label>
                <label class="radio-inline"><input type="radio" name="q8" value="3" checked>3</label>
                <label class="radio-inline"><input type="radio" name="q8" value="4">4</label>
                <label class="radio-inline"><input type="radio" name="q8" value="5">5</label>
            </div>
            <hr class="my-2">
            <h3>Sci Fi</h3>
            <div class="options">
                <label class="radio-inline"><input type="radio" name="q9" value="1">1</label>
                <label class="radio-inline"><input type="radio" name="q9" value="2">2</label>
                <label class="radio-inline"><input type="radio" name="q9" value="3" checked>3</label>
                <label class="radio-inline"><input type="radio" name="q9" value="4">4</label>
                <label class="radio-inline"><input type="radio" name="q9" value="5">5</label>
            </div>
            <hr class="my-2">
            <h3>Fantasy</h3>
            <div class="options">
                <label class="radio-inline"><input type="radio" name="q10" value="1">1</label>
                <label class="radio-inline"><input type="radio" name="q10" value="2">2</label>
                <label class="radio-inline"><input type="radio" name="q10" value="3" checked>3</label>
                <label class="radio-inline"><input type="radio" name="q10" value="4">4</label>
                <label class="radio-inline"><input type="radio" name="q10" value="5">5</label>
            </div>
            <hr class="my-2">
        </div>
        <div class="text-left">
            <button type="submit" class="btn btn-primary btn-md" id="send">Submit Answers</button>
        </div>

        <!-- Modal -->
        <div id="myModal" class="modal" role="dialog">
            <div class="modal-dialog">
                
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Meet your Match!</h4>
                    </div>
                    <div class="modal-body">
                        <p>Based off your movie preferences, we found someone for you to watch movies with:</p>
                        <strong><h2 id="matchName"></h2></strong>
                        <img src="" class="img-thumbnail" id="matchPic" onerror="this.src='https://thumbs.dreamstime.com/b/default-avatar-profile-icon-grey-photo-placeholder-illustrations-vectors-default-avatar-profile-icon-grey-photo-placeholder-99724602.jpg'">
                    </div>
                    <div class="modal-footer">
                            <a class="btn btn-info btn-lg" href="/" role="button">Go Home</a>
                    </div>
                </div>
      
            </div>
        </div>
    </div>

</body>

<script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<script type="text/javascript">

    $("#send").on("click", function(event) {
        event.preventDefault();
        
        var name = $('#usr').val();
        var picUrl = $('#profPic').val();
        var scores = [];

        if (!name || !picUrl) {
            alert("Please make sure to enter a name and an image url.")
        } else {

            for (let i = 1; i < 11; i++) {
                var chosen = $('input[name="q'+i+'"]:checked').val();
                scores.push(parseInt(chosen));
            };

            var userData = {
                name: name,
                photo: picUrl,
                scores: scores
            }

            $.post("/api/friends", userData).then(function(data) {
                console.log('returned data', data)
                $('#matchName').text(data.name)
                $('#matchPic').attr('src', data.photo)
                $("#myModal").modal({backdrop: 'static', keyboard: false})
            })
        }
    })

    function replaceImg() {
        $('#matchPic').attr('src', '"https://thumbs.dreamstime.com/b/default-avatar-profile-icon-grey-photo-placeholder-illustrations-vectors-default-avatar-profile-icon-grey-photo-placeholder-99724602.jpg"')
    }

</script>
</html>